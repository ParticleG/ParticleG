import{Q as G,a as Z}from"./QPage-CtF_H4iM.js";import{e as J,ap as I,h as A,aq as ee,i as te,q as ie,O as Q,f as x,g as ae,R as re,U as C,_ as R,o as d,c as P,ar as j,an as L,G as _,j as Y,V as v,a as S,d as c,w as u,aa as N,am as T,a1 as b,ao as E,$ as X,as as oe,k as U,a4 as ne,a0 as O,a3 as le,W as H}from"./index-D9zY629U.js";import{Q as D}from"./QTooltip-W0mXt4hH.js";import{Q as F}from"./QScrollArea-BZs8QiME.js";import{u as se}from"./use-quasar-BgrbG0Y1.js";import{s as $}from"./common-Bk-9SMvx.js";import"./use-dark-B-FvlCaa.js";import"./selection-BoZykA1B.js";import"./use-model-toggle-BiJwUGZY.js";import"./focus-manager-DWCfG0Vr.js";import"./scroll-DYweQj4i.js";import"./QResizeObserver-HImiDEfa.js";import"./QScrollObserver-DiPjjY_w.js";import"./TouchPan-GE38YP5k.js";import"./format-jE6H2BG5.js";import"./i18n-D2fcLSDt.js";import"./vue-i18n.runtime-Dehq6bdw.js";const ce='<g><path fill="none" stroke="currentColor" stroke-width="5" stroke-miterlimit="10" d="M58.4,51.7c-0.9-0.9-1.4-2-1.4-2.3s0.5-0.4,1.4-1.4 C70.8,43.8,79.8,30.5,80,15.5H70H30H20c0.2,15,9.2,28.1,21.6,32.3c0.9,0.9,1.4,1.2,1.4,1.5s-0.5,1.6-1.4,2.5 C29.2,56.1,20.2,69.5,20,85.5h10h40h10C79.8,69.5,70.8,55.9,58.4,51.7z"></path><clipPath id="uil-hourglass-clip1"><rect x="15" y="20" width="70" height="25"><animate attributeName="height" from="25" to="0" dur="1s" repeatCount="indefinite" values="25;0;0" keyTimes="0;0.5;1"></animate><animate attributeName="y" from="20" to="45" dur="1s" repeatCount="indefinite" values="20;45;45" keyTimes="0;0.5;1"></animate></rect></clipPath><clipPath id="uil-hourglass-clip2"><rect x="15" y="55" width="70" height="25"><animate attributeName="height" from="0" to="25" dur="1s" repeatCount="indefinite" values="0;25;25" keyTimes="0;0.5;1"></animate><animate attributeName="y" from="80" to="55" dur="1s" repeatCount="indefinite" values="80;55;55" keyTimes="0;0.5;1"></animate></rect></clipPath><path d="M29,23c3.1,11.4,11.3,19.5,21,19.5S67.9,34.4,71,23H29z" clip-path="url(#uil-hourglass-clip1)" fill="currentColor"></path><path d="M71.6,78c-3-11.6-11.5-20-21.5-20s-18.5,8.4-21.5,20H71.6z" clip-path="url(#uil-hourglass-clip2)" fill="currentColor"></path><animateTransform attributeName="transform" type="rotate" from="0 50 50" to="180 50 50" repeatCount="indefinite" dur="1s" values="0 50 50;0 50 50;180 50 50" keyTimes="0;0.7;1"></animateTransform></g>',ue=J({name:"QSpinnerHourglass",props:ee,setup(a){const{cSize:t,classes:e}=I(a);return()=>A("svg",{class:e.value,width:t.value,height:t.value,viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",xmlns:"http://www.w3.org/2000/svg",innerHTML:ce})}}),de={position:{type:String,default:"bottom-right",validator:a=>["top-right","top-left","bottom-right","bottom-left","top","right","bottom","left"].includes(a)},offset:{type:Array,validator:a=>a.length===2},expand:Boolean};function he(){const{props:a,proxy:{$q:t}}=te(),e=ie(re,Q);if(e===Q)return console.error("QPageSticky needs to be child of QLayout"),Q;const i=x(()=>{const l=a.position;return{top:l.indexOf("top")!==-1,right:l.indexOf("right")!==-1,bottom:l.indexOf("bottom")!==-1,left:l.indexOf("left")!==-1,vertical:l==="top"||l==="bottom",horizontal:l==="left"||l==="right"}}),r=x(()=>e.header.offset),s=x(()=>e.right.offset),o=x(()=>e.footer.offset),n=x(()=>e.left.offset),z=x(()=>{let l=0,w=0;const y=i.value,V=t.lang.rtl===!0?-1:1;y.top===!0&&r.value!==0?w=`${r.value}px`:y.bottom===!0&&o.value!==0&&(w=`${-o.value}px`),y.left===!0&&n.value!==0?l=`${V*n.value}px`:y.right===!0&&s.value!==0&&(l=`${-V*s.value}px`);const g={transform:`translate(${l}, ${w})`};return a.offset&&(g.margin=`${a.offset[1]}px ${a.offset[0]}px`),y.vertical===!0?(n.value!==0&&(g[t.lang.rtl===!0?"right":"left"]=`${n.value}px`),s.value!==0&&(g[t.lang.rtl===!0?"left":"right"]=`${s.value}px`)):y.horizontal===!0&&(r.value!==0&&(g.top=`${r.value}px`),o.value!==0&&(g.bottom=`${o.value}px`)),g}),B=x(()=>`q-page-sticky row flex-center fixed-${a.position} q-page-sticky--${a.expand===!0?"expand":"shrink"}`);function p(l){const w=ae(l.default);return A("div",{class:B.value,style:z.value},a.expand===!0?w:[A("div",w)])}return{$layout:e,getStickyContent:p}}const me=J({name:"QPageSticky",props:de,setup(a,{slots:t}){const{getStickyContent:e}=he();return()=>e(t)}}),pe=C({__name:"CurrentPlayerIndicator",props:{modelValue:{},offset:{},size:{default:145}},setup(a,{expose:t}){t();const e={};return Object.defineProperty(e,"__isScriptSetup",{enumerable:!1,value:!0}),e}});function fe(a,t,e,i,r,s){return d(),P(L,{class:"q-ma-sm",name:"mdi-arrow-up-bold",color:"green",size:"md",style:j([{transition:"all 0.25s ease-in-out","z-index":"100"},{left:`${e.modelValue.x*e.size+e.offset}px`,top:`${30+e.modelValue.y*e.size}px`}])},null,8,["style"])}const _e=R(pe,[["render",fe],["__file","CurrentPlayerIndicator.vue"]]),ge=C({__name:"GameLog",props:{modelValue:{}},setup(a,{expose:t}){t();const e=a,i=_();Y(()=>e.modelValue.length,()=>{i.value?.setScrollPercentage("vertical",100,200)},{deep:!0});const r={props:e,logScroll:i,get QScrollArea(){return F}};return Object.defineProperty(r,"__isScriptSetup",{enumerable:!1,value:!0}),r}}),ve={class:"column",style:{height:"calc(20vh - 100px)"}};function we(a,t,e,i,r,s){return d(),v("div",ve,[t[0]||(t[0]=S("div",{class:"text-h6"},"Game Log",-1)),c(G,{class:"col-grow",bordered:"",flat:"",style:{"border-color":"var(--q-primary)","border-width":"2px"}},{default:u(()=>[c(i.QScrollArea,{ref:"logScroll",class:"full-height"},{default:u(()=>[(d(!0),v(N,null,T(e.modelValue,(o,n)=>(d(),v("div",{key:n,style:{"white-space":"pre"}},b(o),1))),128))]),_:1},512)]),_:1})])}const ye=R(ge,[["render",we],["__file","GameLog.vue"]]),xe=C({__name:"GameBlock",props:{modelValue:{},size:{default:145}},setup(a,{expose:t}){t();const e={};return Object.defineProperty(e,"__isScriptSetup",{enumerable:!1,value:!0}),e}}),be={class:"absolute-bottom-left"};function ke(a,t,e,i,r,s){return d(!0),v(N,null,T(e.modelValue.map,(o,n)=>(d(),P(G,{key:n,class:"row justify-center items-center absolute q-pa-lg",bordered:"",flat:"",style:j([{"border-width":"2px"},{left:`${o.x*e.size}px`,top:`${o.y*e.size}px`,height:`${e.size}px`,width:`${e.size}px`}])},{default:u(()=>[S("div",null,b(o.label),1),S("div",be,"No."+b(n),1),o.direction?(d(),v("div",{key:0,class:E(["flex flex-center",{"absolute-top":o.direction==="up","absolute-bottom":o.direction==="down","absolute-left":o.direction==="left","absolute-right":o.direction==="right"}])},[c(X,{class:"no-pointer-events",color:"grey-4",round:"",size:"md","text-color":"white",unelevated:"",style:j([{"z-index":"10"},{left:o.direction==="right"?"18px":o.direction==="left"?"-18px":0,top:o.direction==="down"?"18px":o.direction==="up"?"-18px":0}])},{default:u(()=>[c(L,{name:`mdi-chevron-${o.direction}`,size:"md"},null,8,["name"])]),_:2},1032,["style"])],2)):oe("",!0)]),_:2},1032,["style"]))),128)}const Me=R(xe,[["render",ke],["__file","GameBlock.vue"]]),Se=C({__name:"GamePlayer",props:{modelValue:{},active:{type:Boolean},offset:{},size:{default:145}},setup(a,{expose:t}){t();const e=a,i=_(!0),r=_();U(()=>{r.value=setInterval(()=>{if(!e.active){i.value=!0;return}i.value=!i.value},2500)}),ne(()=>{clearInterval(r.value)});const s={props:e,animate:i,animationInterval:r};return Object.defineProperty(s,"__isScriptSetup",{enumerable:!1,value:!0}),s}}),Pe=["src","alt"];function ze(a,t,e,i,r,s){return d(),v("div",{class:E(["q-ma-sm",{animate_avatar:e.active&&i.animate}]),style:j([{border:"2px solid var(--q-primary)","border-radius":"50%",transition:"all 0.25s ease-in-out","z-index":"100"},{left:`${e.modelValue.x*e.size+e.offset}px`,top:`${e.modelValue.y*e.size}px`,zIndex:e.active?100:1}])},[c(X,{size:"30px"},{default:u(()=>[S("img",{src:e.modelValue.avatar,alt:`Player ${e.modelValue.id}`},null,8,Pe)]),_:1}),c(D,{anchor:"top middle",self:"bottom middle","transition-hide":"jump-down","transition-show":"jump-up"},{default:u(()=>[O(" [P"+b(e.modelValue.id)+"] "+b(e.modelValue.name),1)]),_:1})],6)}const Be=R(Se,[["render",ze],["__scopeId","data-v-3f611fc2"],["__file","GamePlayer.vue"]]);var M=(a=>(a.Begin="Begin",a.End="End",a.Normal="Normal",a.Jump="Jump",a.Move="Move",a.Skip="Skip",a.ReRoll="ReRoll",a.DiceModifier="DiceModifier",a))(M||{});class Ce{type="Begin";label="Begin";description="The start of the adventure.";direction;constructor(t){this.direction=t}}class Re{type="End";label="End";description="The end of the adventure.";direction}class h{type="Normal";label;description;direction;constructor(t,e="",i="A normal block."){this.label=e,this.description=i,this.direction=t}}class Ve{type="Jump";label;description;direction;data;constructor(t,e="Jump",i="Jump to a specific block.",r){this.data=t,this.label=e,this.description=i,this.direction=r}}class m{type="Move";label;description;direction;data;constructor(t,e="Move",i="Move a specific number of blocks.",r){this.data=t,this.label=e,this.description=i,this.direction=r}}class qe{type="Skip";label;description;direction;data;constructor(t,e="Skip",i="Skip a specific number of blocks.",r){this.data=t,this.label=e,this.description=i,this.direction=r}}class $e{type="ReRoll";label="ReRoll";description="ReRoll the dice.";direction;constructor(t){this.direction=t}}class k{type="DiceModifier";label="ReRoll";description="ReRoll the dice.";direction;data;constructor(t,e="Dice Modifier",i="Modify the next dice roll.",r){this.data=t,this.label=e,this.description=i,this.direction=r}}class q{id;name;avatar;position;skip;diceModifier;x=0;y=0;constructor(t,e,i){this.id=t,this.name=e,this.avatar=i,this.position=0,this.skip=0}}class je{_height;_map;_players;_interval=500;_width;_log=[];_round=0;_speed=1;_turn=0;constructor(t,e){this._map=t,this._players=e,this._height=Math.max(...this._map.map((i,r)=>this._calculateOffsetY(r))),this._width=Math.max(...this._map.map((i,r)=>this._calculateOffsetX(r)))}get currentPlayer(){return this.players[this._turn]}get height(){return this._height}get log(){return this._log}get map(){return this._map.map((t,e)=>({...t,x:this._calculateOffsetX(e),y:this._calculateOffsetY(e)}))}get players(){return this._players.map(t=>({...t,x:this._calculateOffsetX(t.position),y:this._calculateOffsetY(t.position)}))}get round(){return this._round}get turn(){return this._turn}get width(){return this._width}get winner(){return this._players.find(t=>t.position>=this._map.length-1)}async move(t,e){const i=this._players[this._turn];if(i.skip>0){i.skip--,this._log.push(`${i.name} skipped this turn, ${i.skip} skip turn(s) left`);return}i.position+=t,await $(this._interval/this._speed),i.position>=this._map.length&&(i.position=this._map.length-1-(i.position-this._map.length),this._log.push(`${i.name} went too far, go back to No.${i.position} block`),await $(this._interval/this._speed));let r=this._map[i.position];for(;r;){if(this._executeBlock(i,r))return r.type;r=this._map[i.position],e?.(r.type),await $(this._interval/this._speed)}}nextTurn(){this._turn++,this._log.push(" "),this._turn>=this._players.length&&(this._turn=0,this._round++,this._log.push(`>> Round ${this._round+1}`))}reset(){this._players.forEach(t=>{t.position=0,t.skip=0,t.diceModifier=e=>e}),this._log=["Game started"],this._round=0,this._turn=0}async rollDice(){return new Promise(t=>{setTimeout(()=>{const e=this._players[this._turn];let i=Math.floor(Math.random()*6)+1;e.diceModifier&&(i=e.diceModifier(Math.floor(Math.random()*6)+1),e.diceModifier=void 0),this._log.push(`${e.name} rolled ${i}`),t(i)},100+Math.random()*200)})}setSpeed(t){return t>0?(this._speed=t,!0):!1}_calculateOffsetX(t){return this._map.slice(0,t).filter(e=>e.direction==="right").length-this._map.slice(0,t).filter(e=>e.direction==="left").length}_calculateOffsetY(t){return this._map.slice(0,t).filter(e=>e.direction==="down").length-this._map.slice(0,t).filter(e=>e.direction==="up").length}_executeBlock(t,e){switch(e.type){case M.Jump:{const i=e.data>=0?e.data:this._map.length+e.data;return t.position=i,this._log.push(`${t.name} jumped to No.${i} block`),!1}case M.Move:return t.position+=e.data,this._log.push(`${t.name} moved ${e.data} block(s)`),!1;case M.Skip:return t.skip+=e.data,this._log.push(`${t.name} would skip next ${e.data} turn(s)`),!0;case M.ReRoll:return this._log.push(`${t.name} got a re-roll!`),!0;case M.DiceModifier:return t.diceModifier=e.data,this._log.push(`${t.name} got a dice modifier: "${e.label}"`),!0;default:return!0}}}const Qe=[new Ce("right"),new Ve(-1,"To the End","Jump straight to the end block","right"),new h("right"),new m(-1,"Move back 1","Move 2 blocks backwards","right"),new $e("right"),new h("down"),new m(-3,"Move back 3","Move 3 blocks backwards","left"),new h("left"),new m(-2,"Move back 2","Move 2 blocks backwards","left"),new m(-1,"Move back 1","Move 1 block backwards","left"),new h("left"),new k(a=>a+1,"Dice + 1","Add 1 to the next dice roll","down"),new qe(1,"Skip 1","Skip 1 round","right"),new m(1,"Move forward 1","Move 1 block forward","right"),new h("right"),new m(-1,"Move back 1","Move 1 block backwards","right"),new k(a=>a*2,"Dice * 2","Multiply by 2 to the next dice roll","right"),new h("down"),new m(-1,"Move back 1","Move 1 block backwards","left"),new m(-1,"Move back 1","Move 1 block backwards","left"),new m(-1,"Move back 1","Move 1 block backwards","left"),new h("left"),new k(a=>a-3,"Dice - 3","Subtract 3 to the next dice roll","left"),new m(-3,"Move back 3","Move 3 block backwards","down"),new h("right"),new m(1,"Move forward 1","Move 1 block forward","right"),new h("right"),new h("right","Other move 1","Make someone move 1 block forward"),new h("right","Hospital Exit","Exit of the hospital"),new m(-4,"Move back 4","Move 4 block backwards","down"),new h("left"),new k(a=>a/2,"Dice / 2","Divide by 2 to the next dice roll","left"),new k(a=>a*3,"Dice * 3","Multiply by 3 to the next dice roll","left"),new k(a=>a**2,"Dice ** 2","Squared to the next dice roll","left"),new k(a=>Math.floor(Math.sqrt(a)),"floor(sqrt(Dice))","Square root to the next dice roll (floored)","left"),new h("down"),new h("right"),new m(-2,"Move back 2","Move 2 block backwards","right"),new Re],Ae=C({__name:"BlockAdventurePage",setup(a,{expose:t}){t();const{screen:e}=se(),i=x(()=>e.lt.md),r=le(new je(Qe,[new q(1,"Mike","https://cdn.quasar.dev/img/avatar1.jpg"),new q(2,"Mary","https://cdn.quasar.dev/img/avatar2.jpg"),new q(3,"Alice","https://cdn.quasar.dev/img/avatar3.jpg"),new q(4,"John","https://cdn.quasar.dev/img/avatar4.jpg")])),s=_(""),o=_(),n=_(!1),z=_(0),B=_(145),p=_(0),l=_(),w=async()=>{n.value=!0,p.value=0,z.value=await r.rollDice(),p.value=30;const f=await r.move(z.value,()=>{p.value<70?p.value+=10:p.value<90?p.value+=5:p.value<100&&(p.value+=1)});switch(p.value=100,await $(500),f){case M.ReRoll:{n.value=!1;return}}if(r.winner){l.value=r.winner,n.value=!1;return}r.nextTurn(),n.value=!1};Y(()=>r.currentPlayer,f=>{o.value?.setScrollPosition("horizontal",f.x*B.value,200),o.value?.setScrollPosition("vertical",f.y*B.value,200)},{deep:!0});const y=()=>{n.value=!0,r.reset(),l.value=void 0,n.value=!1},V=f=>{const K=f.horizontalPosition===0?"-4rem":f.horizontalPosition===1?"4rem":"0",W=f.verticalPosition===0?"-4rem":f.verticalPosition===1?"4rem":"0";console.log(f),s.value=`inset ${K} ${W} 4rem rgba(0, 255, 255, 0.5)`};U(()=>{r.reset()});const g={screen:e,isMobile:i,game:r,boxShadow:s,gameScrollArea:o,loading:n,point:z,size:B,turnPercentage:p,winner:l,nextTurn:w,newGame:y,updateBoxShadow:V,get QScrollArea(){return F},CurrentPlayerIndicator:_e,GameLog:ye,GameBlock:Me,GamePlayer:Be};return Object.defineProperty(g,"__isScriptSetup",{enumerable:!1,value:!0}),g}}),Oe={class:"column q-gutter-y-sm"},De={class:"text-h5 text-center"},Ge={key:0,class:"text-body1 text-center"},Ne={key:1,class:"text-body1 text-green text-center"};function Te(a,t,e,i,r,s){return d(),P(Z,{class:"column q-gutter-y-md q-px-md q-px-md-xl q-py-md"},{default:u(()=>[S("div",{class:E(["row items-center q-gutter-x-xl",{"justify-center":i.isMobile,"justify-start":!i.isMobile}])},[S("div",Oe,[S("div",De,"Round "+b(i.game.round+1),1),i.winner?(d(),v("div",Ne,b(i.winner.name)+" is the winner! ",1)):(d(),v("div",Ge,b(i.game.players[i.game.turn].name)+"'s Turn ",1))]),c(i.GameLog,{class:"col-grow col-md-2","model-value":i.game.log,style:{height:"calc(20vh - 100px)"}},null,8,["model-value"])],2),c(G,null,{default:u(()=>[c(i.QScrollArea,{ref:"gameScrollArea",style:{height:"80vh"},onScroll:i.updateBoxShadow},{default:u(()=>[c(i.GameBlock,{modelValue:i.game,"onUpdate:modelValue":t[0]||(t[0]=o=>i.game=o)},null,8,["modelValue"]),(d(!0),v(N,null,T(i.game.players,(o,n)=>(d(),P(i.GamePlayer,{key:n,class:"absolute",active:!i.loading&&i.game.currentPlayer.id===o.id,offset:n*25,"model-value":o},null,8,["active","offset","model-value"]))),128)),c(i.CurrentPlayerIndicator,{class:"absolute",offset:i.game.turn*25,modelValue:i.game.currentPlayer,"onUpdate:modelValue":t[1]||(t[1]=o=>i.game.currentPlayer=o)},null,8,["offset","modelValue"])]),_:1},512)]),_:1}),c(me,{position:i.isMobile?"bottom-right":"top",offset:[18,18]},{default:u(()=>[i.winner?(d(),P(H,{key:1,icon:"mdi-restart",color:"primary",dense:"",size:"lg",outline:"",onClick:i.newGame},{default:u(()=>[c(D,{anchor:"center left",self:"center right","transition-hide":"jump-right","transition-show":"jump-left"},{default:u(()=>t[3]||(t[3]=[O(" New Game ")])),_:1})]),_:1})):(d(),P(H,{key:0,class:"text-h5",color:"primary",disable:!!i.winner,label:i.point,loading:i.loading,padding:"none",percentage:i.turnPercentage,onClick:i.nextTurn,style:{height:"3rem",width:"3rem"}},{loading:u(()=>[c(ue)]),default:u(()=>[c(D,{anchor:"center left",self:"center right","transition-hide":"jump-right","transition-show":"jump-left"},{default:u(()=>t[2]||(t[2]=[O(" Roll the dice ")])),_:1})]),_:1},8,["disable","label","loading","percentage"]))]),_:1},8,["position"])]),_:1})}const ot=R(Ae,[["render",Te],["__file","BlockAdventurePage.vue"]]);export{ot as default};
