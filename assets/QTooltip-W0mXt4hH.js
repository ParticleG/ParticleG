import{i as it,G as P,C as q,B as Y,n as gt,ac as pt,j as W,t as N,k as xt,m as A,l as G,a4 as yt,ad as bt,h as z,e as at,ae as Tt,af as wt,ag as Ht,f as C,u as St,g as Et,T as Ct,z as Wt}from"./index-D9zY629U.js";import{c as R,u as Pt}from"./selection-BoZykA1B.js";import{u as Mt,a as kt,b as Lt}from"./use-model-toggle-BiJwUGZY.js";import{r as J,a as $t,u as qt}from"./focus-manager-DWCfG0Vr.js";import{e as At,g as zt,s as Dt}from"./scroll-DYweQj4i.js";const jt={target:{type:[Boolean,String,Element],default:!0},noParentEvent:Boolean};function Qt({showing:t,avoidEmit:n,configureAnchorEl:l}){const{props:e,proxy:o,emit:s}=it(),i=P(null);let r=null;function d(a){return i.value===null?!1:a===void 0||a.touches===void 0||a.touches.length<=1}const u={};l===void 0&&(Object.assign(u,{hide(a){o.hide(a)},toggle(a){o.toggle(a),a.qAnchorHandled=!0},toggleKey(a){pt(a,13)===!0&&u.toggle(a)},contextClick(a){o.hide(a),Y(a),gt(()=>{o.show(a),a.qAnchorHandled=!0})},prevent:Y,mobileTouch(a){if(u.mobileCleanup(a),d(a)!==!0)return;o.hide(a),i.value.classList.add("non-selectable");const c=a.target;q(u,"anchor",[[c,"touchmove","mobileCleanup","passive"],[c,"touchend","mobileCleanup","passive"],[c,"touchcancel","mobileCleanup","passive"],[i.value,"contextmenu","prevent","notPassive"]]),r=setTimeout(()=>{r=null,o.show(a),a.qAnchorHandled=!0},300)},mobileCleanup(a){i.value.classList.remove("non-selectable"),r!==null&&(clearTimeout(r),r=null),t.value===!0&&a!==void 0&&R()}}),l=function(a=e.contextMenu){if(e.noParentEvent===!0||i.value===null)return;let c;a===!0?o.$q.platform.is.mobile===!0?c=[[i.value,"touchstart","mobileTouch","passive"]]:c=[[i.value,"mousedown","hide","passive"],[i.value,"contextmenu","contextClick","notPassive"]]:c=[[i.value,"click","toggle","passive"],[i.value,"keyup","toggleKey","passive"]],q(u,"anchor",c)});function h(){N(u,"anchor")}function p(a){for(i.value=a;i.value.classList.contains("q-anchor--skip");)i.value=i.value.parentNode;l()}function x(){if(e.target===!1||e.target===""||o.$el.parentNode===null)i.value=null;else if(e.target===!0)p(o.$el.parentNode);else{let a=e.target;if(typeof e.target=="string")try{a=document.querySelector(e.target)}catch{a=void 0}a!=null?(i.value=a.$el||a,l()):(i.value=null,console.error(`Anchor: target "${e.target}" not found`))}}return W(()=>e.contextMenu,a=>{i.value!==null&&(h(),l(a))}),W(()=>e.target,()=>{i.value!==null&&h(),x()}),W(()=>e.noParentEvent,a=>{i.value!==null&&(a===!0?h():l())}),xt(()=>{x(),n!==!0&&e.modelValue===!0&&i.value===null&&s("update:modelValue",!1)}),A(()=>{r!==null&&clearTimeout(r),h()}),{anchorEl:i,canShow:d,anchorEvents:u}}function Ot(t,n){const l=P(null);let e;function o(r,d){const u=`${d!==void 0?"add":"remove"}EventListener`,h=d!==void 0?d:e;r!==window&&r[u]("scroll",h,G.passive),window[u]("scroll",h,G.passive),e=d}function s(){l.value!==null&&(o(l.value),l.value=null)}const i=W(()=>t.noParentEvent,()=>{l.value!==null&&(s(),n())});return A(i),{localScrollTarget:l,unconfigureScrollTarget:s,changeScrollEvent:o}}const L=[],Bt=at({name:"QPortal",setup(t,{slots:n}){return()=>n.default()}});function Ft(t){for(t=t.parent;t!=null;){if(t.type.name==="QGlobalDialog")return!0;if(t.type.name==="QDialog"||t.type.name==="QMenu")return!1;t=t.parent}return!1}function Nt(t,n,l,e){const o=P(!1),s=P(!1);let i=null;const r={},d=e==="dialog"&&Ft(t);function u(p){if(p===!0){J(r),s.value=!0;return}s.value=!1,o.value===!1&&(d===!1&&i===null&&(i=wt(!1,e)),o.value=!0,L.push(t.proxy),$t(r))}function h(p){if(s.value=!1,p!==!0)return;J(r),o.value=!1;const x=L.indexOf(t.proxy);x!==-1&&L.splice(x,1),i!==null&&(Ht(i),i=null)}return yt(()=>{h(!0)}),t.proxy.__qPortal=!0,bt(t.proxy,"contentEl",()=>n.value),{showPortal:u,hidePortal:h,portalIsActive:o,portalIsAccessible:s,renderPortal:()=>d===!0?l():o.value===!0?[z(Tt,{to:i},z(Bt,l))]:void 0}}const B={transitionShow:{type:String,default:"fade"},transitionHide:{type:String,default:"fade"},transitionDuration:{type:[String,Number],default:300}};function Gt(t,n=()=>{},l=()=>{}){return{transitionProps:C(()=>{const e=`q-transition--${t.transitionShow||n()}`,o=`q-transition--${t.transitionHide||l()}`;return{appear:!0,enterFromClass:`${e}-enter-from`,enterActiveClass:`${e}-enter-active`,enterToClass:`${e}-enter-to`,leaveFromClass:`${o}-leave-from`,leaveActiveClass:`${o}-leave-active`,leaveToClass:`${o}-leave-to`}}),transitionStyle:C(()=>`--q-transition-duration: ${t.transitionDuration}ms`)}}const{notPassiveCapture:D}=G,S=[];function j(t){const n=t.target;if(n===void 0||n.nodeType===8||n.classList.contains("no-pointer-events")===!0)return;let l=L.length-1;for(;l>=0;){const e=L[l].$;if(e.type.name==="QTooltip"){l--;continue}if(e.type.name!=="QDialog")break;if(e.props.seamless!==!0)return;l--}for(let e=S.length-1;e>=0;e--){const o=S[e];if((o.anchorEl.value===null||o.anchorEl.value.contains(n)===!1)&&(n===document.body||o.innerRef.value!==null&&o.innerRef.value.contains(n)===!1))t.qClickOutside=!0,o.onClickOutside(t);else return}}function Rt(t){S.push(t),S.length===1&&(document.addEventListener("mousedown",j,D),document.addEventListener("touchstart",j,D))}function Z(t){const n=S.findIndex(l=>l===t);n!==-1&&(S.splice(n,1),S.length===0&&(document.removeEventListener("mousedown",j,D),document.removeEventListener("touchstart",j,D)))}let tt,et;function nt(t){const n=t.split(" ");return n.length!==2?!1:["top","center","bottom"].includes(n[0])!==!0?(console.error("Anchor/Self position must start with one of top/center/bottom"),!1):["left","middle","right","start","end"].includes(n[1])!==!0?(console.error("Anchor/Self position must end with one of left/middle/right/start/end"),!1):!0}function It(t){return t?!(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number"):!0}const I={"start#ltr":"left","start#rtl":"right","end#ltr":"right","end#rtl":"left"};["left","middle","right"].forEach(t=>{I[`${t}#ltr`]=t,I[`${t}#rtl`]=t});function lt(t,n){const l=t.split(" ");return{vertical:l[0],horizontal:I[`${l[1]}#${n===!0?"rtl":"ltr"}`]}}function Vt(t,n){let{top:l,left:e,right:o,bottom:s,width:i,height:r}=t.getBoundingClientRect();return n!==void 0&&(l-=n[1],e-=n[0],s+=n[1],o+=n[0],i+=n[0],r+=n[1]),{top:l,bottom:s,height:r,left:e,right:o,width:i,middle:e+(o-e)/2,center:l+(s-l)/2}}function _t(t,n,l){let{top:e,left:o}=t.getBoundingClientRect();return e+=n.top,o+=n.left,l!==void 0&&(e+=l[1],o+=l[0]),{top:e,bottom:e+1,height:1,left:o,right:o+1,width:1,middle:o,center:e}}function Kt(t,n){return{top:0,center:n/2,bottom:n,left:0,middle:t/2,right:t}}function ot(t,n,l,e){return{top:t[l.vertical]-n[e.vertical],left:t[l.horizontal]-n[e.horizontal]}}function rt(t,n=0){if(t.targetEl===null||t.anchorEl===null||n>5)return;if(t.targetEl.offsetHeight===0||t.targetEl.offsetWidth===0){setTimeout(()=>{rt(t,n+1)},10);return}const{targetEl:l,offset:e,anchorEl:o,anchorOrigin:s,selfOrigin:i,absoluteOffset:r,fit:d,cover:u,maxHeight:h,maxWidth:p}=t;if(St.is.ios===!0&&window.visualViewport!==void 0){const E=document.body.style,{offsetLeft:g,offsetTop:y}=window.visualViewport;g!==tt&&(E.setProperty("--q-pe-left",g+"px"),tt=g),y!==et&&(E.setProperty("--q-pe-top",y+"px"),et=y)}const{scrollLeft:x,scrollTop:a}=l,c=r===void 0?Vt(o,u===!0?[0,0]:e):_t(o,r,e);Object.assign(l.style,{top:0,left:0,minWidth:null,minHeight:null,maxWidth:p,maxHeight:h,visibility:"visible"});const{offsetWidth:T,offsetHeight:M}=l,{elWidth:Q,elHeight:$}=d===!0||u===!0?{elWidth:Math.max(c.width,T),elHeight:u===!0?Math.max(c.height,M):M}:{elWidth:T,elHeight:M};let v={maxWidth:p,maxHeight:h};(d===!0||u===!0)&&(v.minWidth=c.width+"px",u===!0&&(v.minHeight=c.height+"px")),Object.assign(l.style,v);const w=Kt(Q,$);let f=ot(c,w,s,i);if(r===void 0||e===void 0)F(f,c,w,s,i);else{const{top:E,left:g}=f;F(f,c,w,s,i);let y=!1;if(f.top!==E){y=!0;const b=2*e[1];c.center=c.top-=b,c.bottom-=b+2}if(f.left!==g){y=!0;const b=2*e[0];c.middle=c.left-=b,c.right-=b+2}y===!0&&(f=ot(c,w,s,i),F(f,c,w,s,i))}v={top:f.top+"px",left:f.left+"px"},f.maxHeight!==void 0&&(v.maxHeight=f.maxHeight+"px",c.height>f.maxHeight&&(v.minHeight=v.maxHeight)),f.maxWidth!==void 0&&(v.maxWidth=f.maxWidth+"px",c.width>f.maxWidth&&(v.minWidth=v.maxWidth)),Object.assign(l.style,v),l.scrollTop!==a&&(l.scrollTop=a),l.scrollLeft!==x&&(l.scrollLeft=x)}function F(t,n,l,e,o){const s=l.bottom,i=l.right,r=At(),d=window.innerHeight-r,u=document.body.clientWidth;if(t.top<0||t.top+s>d)if(o.vertical==="center")t.top=n[e.vertical]>d/2?Math.max(0,d-s):0,t.maxHeight=Math.min(s,d);else if(n[e.vertical]>d/2){const h=Math.min(d,e.vertical==="center"?n.center:e.vertical===o.vertical?n.bottom:n.top);t.maxHeight=Math.min(s,h),t.top=Math.max(0,h-s)}else t.top=Math.max(0,e.vertical==="center"?n.center:e.vertical===o.vertical?n.top:n.bottom),t.maxHeight=Math.min(s,d-t.top);if(t.left<0||t.left+i>u)if(t.maxWidth=Math.min(i,u),o.horizontal==="middle")t.left=n[e.horizontal]>u/2?Math.max(0,u-i):0;else if(n[e.horizontal]>u/2){const h=Math.min(u,e.horizontal==="middle"?n.middle:e.horizontal===o.horizontal?n.right:n.left);t.maxWidth=Math.min(i,h),t.left=Math.max(0,h-t.maxWidth)}else t.left=Math.max(0,e.horizontal==="middle"?n.middle:e.horizontal===o.horizontal?n.left:n.right),t.maxWidth=Math.min(i,u-t.left)}const te=at({name:"QTooltip",inheritAttrs:!1,props:{...jt,...Lt,...B,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{...B.transitionShow,default:"jump-down"},transitionHide:{...B.transitionHide,default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:nt},self:{type:String,default:"top middle",validator:nt},offset:{type:Array,default:()=>[14,14],validator:It},scrollTarget:Dt,delay:{type:Number,default:0},hideDelay:{type:Number,default:0},persistent:Boolean},emits:[...kt],setup(t,{slots:n,emit:l,attrs:e}){let o,s;const i=it(),{proxy:{$q:r}}=i,d=P(null),u=P(!1),h=C(()=>lt(t.anchor,r.lang.rtl)),p=C(()=>lt(t.self,r.lang.rtl)),x=C(()=>t.persistent!==!0),{registerTick:a,removeTick:c}=qt(),{registerTimeout:T}=Pt(),{transitionProps:M,transitionStyle:Q}=Gt(t),{localScrollTarget:$,changeScrollEvent:v,unconfigureScrollTarget:w}=Ot(t,U),{anchorEl:f,canShow:E,anchorEvents:g}=Qt({showing:u,configureAnchorEl:ht}),{show:y,hide:b}=Mt({showing:u,canShow:E,handleShow:ut,handleHide:ct,hideOnRouteChange:x,processOnMount:!0});Object.assign(g,{delayShow:dt,delayHide:ft});const{showPortal:V,hidePortal:_,renderPortal:st}=Nt(i,d,vt,"tooltip");if(r.platform.is.mobile===!0){const m={anchorEl:f,innerRef:d,onClickOutside(H){return b(H),H.target.classList.contains("q-dialog__backdrop")&&Wt(H),!0}},O=C(()=>t.modelValue===null&&t.persistent!==!0&&u.value===!0);W(O,H=>{(H===!0?Rt:Z)(m)}),A(()=>{Z(m)})}function ut(m){V(),a(()=>{s=new MutationObserver(()=>k()),s.observe(d.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),k(),U()}),o===void 0&&(o=W(()=>r.screen.width+"|"+r.screen.height+"|"+t.self+"|"+t.anchor+"|"+r.lang.rtl,k)),T(()=>{V(!0),l("show",m)},t.transitionDuration)}function ct(m){c(),_(),K(),T(()=>{_(!0),l("hide",m)},t.transitionDuration)}function K(){s!==void 0&&(s.disconnect(),s=void 0),o!==void 0&&(o(),o=void 0),w(),N(g,"tooltipTemp")}function k(){rt({targetEl:d.value,offset:t.offset,anchorEl:f.value,anchorOrigin:h.value,selfOrigin:p.value,maxHeight:t.maxHeight,maxWidth:t.maxWidth})}function dt(m){if(r.platform.is.mobile===!0){R(),document.body.classList.add("non-selectable");const O=f.value,H=["touchmove","touchcancel","touchend","click"].map(X=>[O,X,"delayHide","passiveCapture"]);q(g,"tooltipTemp",H)}T(()=>{y(m)},t.delay)}function ft(m){r.platform.is.mobile===!0&&(N(g,"tooltipTemp"),R(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),T(()=>{b(m)},t.hideDelay)}function ht(){if(t.noParentEvent===!0||f.value===null)return;const m=r.platform.is.mobile===!0?[[f.value,"touchstart","delayShow","passive"]]:[[f.value,"mouseenter","delayShow","passive"],[f.value,"mouseleave","delayHide","passive"]];q(g,"anchor",m)}function U(){if(f.value!==null||t.scrollTarget!==void 0){$.value=zt(f.value,t.scrollTarget);const m=t.noParentEvent===!0?k:b;v($.value,m)}}function mt(){return u.value===!0?z("div",{...e,ref:d,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",e.class],style:[e.style,Q.value],role:"tooltip"},Et(n.default)):null}function vt(){return z(Ct,M.value,mt)}return A(K),Object.assign(i.proxy,{updatePosition:k}),st}});export{te as Q};
